{"version":3,"sources":["../src/datasource.js"],"names":["_","SLS","GenericDatasource","instanceSettings","$q","backendSrv","templateSrv","type","url","name","projectName","jsonData","project","logstore","user","password","console","log","q","withCredentials","headers","basicAuth","length","defaultConfig","accessId","accessKey","timeout","signature_method","api_version","logger","options","query","targets","slsclient","GetData","parseInt","range","from","_d","getTime","to","then","result","data","Data","keys","res","i","target","xcol","push","ycol","hasTimeKey","tmpkeys","Object","filter","k","o","obj","xv","finalRes","dataPoints","all_time_pos","j","sorted_time","sort","resDataPoints","t","fres","status","message","title","err","Date","replace","annotation","annotationQuery","datasource","enable","iconColor","rangeRaw","doRequest","method","interpolated","mapToTextValue","map","d","text","value","isObject","datasourceRequest","scopedVars","refId","hide"],"mappings":"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","file":"datasource.js","sourcesContent":["import _ from \"lodash\";\nimport {SLS} from \"./sls.js\";\nexport class GenericDatasource {\n\n  constructor(instanceSettings, $q, backendSrv, templateSrv) {\n    this.type = instanceSettings.type;\n    this.url = instanceSettings.url;\n    this.name = instanceSettings.name;\n    this.projectName = instanceSettings.jsonData.project;\n    this.logstore = instanceSettings.jsonData.logstore;\n    //this.endpoint = instanceSettings.jsonData.endpoint;\n    this.user = instanceSettings.jsonData.user;\n    this.password = instanceSettings.jsonData.password;\n    console.log(instanceSettings);\n    this.q = $q;\n    this.backendSrv = backendSrv;\n    this.templateSrv = templateSrv;\n    this.withCredentials = instanceSettings.withCredentials;\n    this.headers = {'Content-Type': 'application/json'};\n    console.log(this.url);\n    if (typeof instanceSettings.basicAuth === 'string' && instanceSettings.basicAuth.length > 0) {\n      this.headers['Authorization'] = instanceSettings.basicAuth;\n    }\n    this.defaultConfig = { \n\n          //requires\n          accessId: this.user,                  //accessId\n          accessKey: this.password,                 //accessKey\n          //endpoint: this.endpoint,            //sls service endpoint\n\n          //optional\n          timeout: 20000,         //请求timeout时间, 默认: 20s\n\n          signature_method: 'hmac-sha1', //签名计算方式，目前只支持'hmac-sha1', 默认: 'hmac-sha1'\n          api_version: '0.3.0',  //数据相关api version 默认 0.3.0\n\n          logger: false   //打印请求的详细信息, log4js 实例\n      };\n\n  }\n\n  query(options) {\n      console.log(\"query\",options);\n    var query = options.targets[0].query;\n    var slsclient = new SLS(this.defaultConfig,this.backendSrv,this.url);\n    return       slsclient.GetData(this.projectName,\n            {\n            \"Category\" :this.logstore,\n            \"Topic\":\"\",\n            \"BeginTime\":parseInt(options.range.from._d.getTime()/1000),\n            \"EndTime\":parseInt(options.range.to._d.getTime()/1000),\n            \"Query\":query,\n            \"Reverse\":\"false\",\n            \"Lines\":\"100\",\n            \"Offset\":\"0\"\n            }).then(function(result){\n                if(result.data&& result.data.GetData && result.data.GetData.Data){\n                  var data = result.data.GetData.Data;\n                  if (data.length > 0) {\n                    var keys = [];\n                    var res = {};\n                    console.log(data);\n                    for (var i in options.targets) {\n                      var target = options.targets[i];\n                      if(target.xcol)\n                      {\n                        keys.push([target.ycol, target.xcol]);\n                        res[target.ycol] = [];\n                      }\n                    }\n                    var hasTimeKey = true;\n                    \n                    if(keys.length ==0){\n                      var tmpkeys = Object.keys(data[0]).filter(k => k != \"__time__\" && k!= \"__source__\");\n                      hasTimeKey = false;\n                      for(var i in tmpkeys)\n                        keys.push([tmpkeys[i],null]);\n                        res[tmpkeys[i]] =[];\n                    }\n                    console.log(keys);\n\n                    for (var o in data) {\n                      var obj = data[o];\n                      for (var i in keys) {\n                        var k = keys[i];\n                        var xv = null;\n                        if(k[1] != null){\n                          xv=parseInt(obj[k[1]]);\n                          xv = xv * 1000;\n                        }\n                        res[k[0]].push([parseInt(obj[k[0]]), xv]);\n                      }\n                    }\n\n                    var finalRes = [];\n                    for (var i in keys) {\n                      var k = keys[i];\n                      var dataPoints = res[k[0]];\n                      if(!hasTimeKey){\n                        finalRes.push({\n                          \"target\": k[0],\n                          \"datapoints\": dataPoints\n                        })\n                        continue;\n                      }\n                      var all_time_pos = {};\n                      for( var j in dataPoints){\n                        all_time_pos[dataPoints[j][1]]=j;\n                      }\n                      var sorted_time= Object.keys(all_time_pos).sort();\n                      console.log(sorted_time);\n                      var resDataPoints = [];\n                      for(var j in sorted_time){\n                        var t = sorted_time[j];\n                        resDataPoints.push(dataPoints[all_time_pos[t]]);\n                      }\n                      finalRes.push(\n                        {\n                          \"target\": k[0],\n                          \"datapoints\": resDataPoints\n                        }\n                      )\n                    }\n                    console.log(finalRes);\n                    var fres = result;\n                    fres[\"data\"] = finalRes;\n                    return fres;\n                  }\n                }\n                return { status: \"success\", message: \"Database Connection OK\", title: \"Success\" };\n                },function(err){\n                console.log(\"testDataSource err\",err);\n                if (err.data && err.data.message) {\n                return { status: \"error\", message: err.data.message, title: \"Error\" };\n                } else {\n                return { status: \"error\", message: err.status, title: \"Error\" };\n                }\n                });\n  }\n\n  testDatasource() {\n    var slsclient = new SLS(this.defaultConfig,this.backendSrv,this.url);\n    return       slsclient.GetData(this.projectName,\n            {\n            \"Category\" :this.logstore,\n            \"Topic\":\"\",\n            \"BeginTime\":parseInt((new Date().getTime()/1000)-900),\n            \"EndTime\":parseInt(new Date().getTime()/1000),\n            \"Query\":\"\",\n            \"Reverse\":\"false\",\n            \"Lines\":\"10\",\n            \"Offset\":\"0\"\n            }).then(function(result){\n\n                return { status: \"success\", message: \"Database Connection OK\", title: \"Success\" };\n                },function(err){\n                console.log(\"testDataSource err\",err);\n                if (err.data && err.data.message) {\n                return { status: \"error\", message: err.data.message, title: \"Error\" };\n                } else {\n                return { status: \"error\", message: err.status, title: \"Error\" };\n                }\n\n                });\n\n        \n  }\n\n  annotationQuery(options) {\n    var query = this.templateSrv.replace(options.annotation.query, {}, 'glob');\n    var annotationQuery = {\n      range: options.range,\n      annotation: {\n        name: options.annotation.name,\n        datasource: options.annotation.datasource,\n        enable: options.annotation.enable,\n        iconColor: options.annotation.iconColor,\n        query: query\n      },\n      rangeRaw: options.rangeRaw\n    };\n\n    return this.doRequest({\n      url: this.url + '/annotations',\n      method: 'POST',\n      data: annotationQuery\n    }).then(result => {\n      return result.data;\n    });\n  }\n\n  metricFindQuery(query) {\n\n    var interpolated = {\n        target: this.templateSrv.replace(query, null, 'regex')\n    };\n\n    return this.doRequest({\n      url: this.url + '/search',\n      data: interpolated,\n      method: 'POST',\n    }).then(this.mapToTextValue);\n  }\n\n  mapToTextValue(result) {\n    return _.map(result.data, (d, i) => {\n      if (d && d.text && d.value) {\n        return { text: d.text, value: d.value };\n      } else if (_.isObject(d)) {\n        return { text: d, value: i};\n      }\n      return { text: d, value: d };\n    });\n  }\n\n  doRequest(options) {\n    options.withCredentials = this.withCredentials;\n    options.headers = this.headers;\n\n    return this.backendSrv.datasourceRequest(options);\n  }\n\n  buildQueryParameters(options) {\n    //remove placeholder targets\n    options.targets = _.filter(options.targets, target => {\n      return target.target !== 'select metric';\n    });\n\n    var targets = _.map(options.targets, target => {\n      return {\n        target: this.templateSrv.replace(target.target, options.scopedVars, 'regex'),\n        refId: target.refId,\n        hide: target.hide,\n        type: target.type || 'timeserie'\n      };\n    });\n\n    options.targets = targets;\n\n    return options;\n  }\n}\n"]}